@%@UCRWARNING=# @%@

[globals]
bitmap_cache=yes
bitmap_compression=yes
port=3389
crypt_level=low
allow_channels=true
channel_code=1
max_bpp=24
fork=yes
# regulate if the listening socket use socket option tcp_nodelay
# no buffering will be performed in the TCP stack
tcp_nodelay=yes
# regulate if the listening socket use socket option keepalive
# if the network connection disappear without close messages the connection will be closed
tcp_keepalive=yes
#black=000000
#grey=d6d3ce
#dark_grey=808080
#blue=08246b
#dark_blue=08246b
#white=ffffff
#red=ff0000
#green=00ff00
#background=626c72
#autorun=xrdp1
#hidelogwindow=yes
#bulk_compression=yes
title=@%@xrdp/title@%@
imagedir=@%@xrdp/imagedir@%@
# You can set the PAM error text in a gateway setup (MAX 256 chars)
#pamerrortxt=change your password according to policy at http://url
#new_cursors=no

[Logging]
LogFile=xrdp.log
LogLevel=DEBUG
EnableSyslog=1
SyslogLevel=DEBUG
# LogLevel and SysLogLevel could by any of: core, error, warning, info or debug

[channels]
# Channel names not listed here will be blocket by XRDP.
# You can block any channel by setting its value to false.
# IMPORTANT! All channels are not supported in all use
# cases even if you set all values to true.
@!@
for channel in configRegistry.get('xrdp/channels', 'rdpdr rdpsnd drdynvc cliprdr rail xrdpvr').split():
	print '%s=true' % (channel,)

SESSIONS = [
	{
		'name': 'sesman-X11rdp',
		'lib': 'libxup.so',
		'username': 'ask',
		'password': 'ask',
		'ip': '127.0.0.1',
		'port': '-1',
		'xserverbpp': '24',
		'code': '10',
	}, {
		'name': 'sesman-Xvnc',
		'lib': 'libvnc.so',
		'username': 'ask',
		'password': 'ask',
		'ip': '127.0.0.1',
		'port': '-1',
	}, {
		'name': 'console',
		'lib': 'libvnc.so',
		'ip': '127.0.0.1',
		'port': '5900',
		'username': 'na',
		'password': 'ask',
	}, {
		'name': 'vnc-any',
		'lib': 'libvnc.so',
		'ip': 'ask',
		'port': 'ask5900',
		'username': 'na',
		'password': 'ask',
		#'pamusername': 'asksame',
		#'pampassword': 'asksame',
		#'pamsessionmng': '127.0.0.1',
	}, {
		'name': 'sesman-any',
		'lib': 'libvnc.so',
		'ip': 'ask',
		'port': '-1',
		'username': 'ask',
		'password': 'ask',
	}, {
		'name': 'rdp-any',
		'lib': 'librdp.so',
		'ip': 'ask',
		'port': 'ask3389',
	}, {
		'name': 'freerdp-any',
		'lib': 'libxrdpfreerdp1.so',
		'ip': 'ask',
		'port': 'ask3389',
		'username': 'ask',
		'password': 'ask',
		'channel.rdpdr': 'true',
		'channel.rdpsnd': 'true',
		'channel.drdynvc': 'true',
		'channel.cliprdr': 'true',
		'channel.rail': 'true',
		'channel.xrdpvr': 'true',
	},
]
sessions = [_['name'] for _ in SESSIONS]
lookup = dict([(_['name'], _) for _ in SESSIONS])
for key, value in configRegistry.items():
	if key == 'xrdp/sessions':
		sessions = value.split()
	elif not key.startswith('xrdp/session/'):
		continue
	key = key[len('xrdp/session/'):]
	try:
		sess, key = key.split('/', 1)
		lookup.setdefault(sess, {})[key] = value
	except ValueError:
		pass

for i, session in enumerate([lookup[_] for _ in sessions if _ in lookup], start=1):
	print
	print '[xrdp%d]' % (i,)
	for key, value in session.items():
		print '%s=%s' % (key, value)
@!@
